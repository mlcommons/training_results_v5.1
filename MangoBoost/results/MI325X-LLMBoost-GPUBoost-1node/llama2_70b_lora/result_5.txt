/workspace/deps/megatron_lm/megatron/core/rerun_state_machine.py:253: SyntaxWarning: assertion is always true, perhaps remove parentheses?
  assert (
/workspace/deps/megatron_lm/megatron/core/rerun_state_machine.py:264: SyntaxWarning: assertion is always true, perhaps remove parentheses?
  assert (
/workspace/deps/megatron_lm/megatron/core/rerun_state_machine.py:668: SyntaxWarning: assertion is always true, perhaps remove parentheses?
  assert (
/opt/venv/lib/python3.10/site-packages/apex/transformer/functional/fused_rope.py:54: UserWarning: Using the native apex kernel for RoPE.
  warnings.warn("Using the native apex kernel for RoPE.", UserWarning)
/opt/venv/lib/python3.10/site-packages/modelopt/torch/utils/import_utils.py:32: UserWarning: Failed to import peft plugin due to: ImportError("cannot import name 'LocalEntryNotFoundError' from 'huggingface_hub.errors' (/opt/venv/lib/python3.10/site-packages/huggingface_hub/errors.py)"). You may ignore this warning if you do not need this plugin.
  warnings.warn(
Clearing cache on mi325x-01
vm.drop_caches = 3
3
sudo: modprobe: command not found
gfx942
gfx942
gfx942
gfx942
gfx942
gfx942
gfx942
gfx942
sudo: cpupower: command not found
sudo: cpupower: command not found
0
0
0
always
always
STARTING TIMING RUN AT 2025-10-09 11:58:45 PM
[W1009 23:58:46.482867737 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[W1009 23:58:55.817394378 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[W1009 23:58:55.817520685 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[W1009 23:58:55.818980364 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[W1009 23:58:55.819280136 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[W1009 23:58:55.820578870 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[W1009 23:58:55.822969594 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[W1009 23:58:55.824341696 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[W1009 23:58:55.832625946 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:29500 (errno: 97 - Address family not supported by protocol).
[Gloo] Rank 0 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 3 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 1 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 4 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank [Gloo] Rank 5 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
2 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank [Gloo] Rank 76 is connected to  is connected to 77 peer ranks. Expected number of connected peer ranks is :  peer ranks. 7Expected number of connected peer ranks is : 7

[Gloo] Rank 0 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 2 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 1 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7[Gloo] Rank 
4 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7[Gloo] Rank 
5 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 3 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 7 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 6 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 2 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 0 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 3 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 5 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 6 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 4 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 1 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 7 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
Loading distributed checkpoint with TensorStoreLoadShardedStrategy
Loading distributed checkpoint directly on the GPU
> building indices for blendable datasets ...
 > sample ratios:
   dataset 0, input: 1, achieved: 1
:::MLLOG {"namespace": "", "time_ms": 1760054410559, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 278}}
:::MLLOG {"namespace": "", "time_ms": 1760054410561, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 279}}
:::MLLOG {"namespace": "", "time_ms": 1760054410561, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "llama2_70b_lora", "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 280}}
:::MLLOG {"namespace": "", "time_ms": 1760054410561, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "MangoBoost", "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 280}}
:::MLLOG {"namespace": "", "time_ms": 1760054410562, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "closed", "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 280}}
:::MLLOG {"namespace": "", "time_ms": 1760054410562, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "onprem", "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 280}}
:::MLLOG {"namespace": "", "time_ms": 1760054410562, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "1xMI325X", "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 280}}
:::MLLOG {"namespace": "", "time_ms": 1760054410562, "event_type": "POINT_IN_TIME", "key": "seed", "value": 76, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 283}}
:::MLLOG {"namespace": "", "time_ms": 1760054410562, "event_type": "POINT_IN_TIME", "key": "global_batch_size", "value": 8, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 289}}
:::MLLOG {"namespace": "", "time_ms": 1760054410783, "event_type": "POINT_IN_TIME", "key": "train_samples", "value": 3901, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 294}}
:::MLLOG {"namespace": "", "time_ms": 1760054410793, "event_type": "POINT_IN_TIME", "key": "eval_samples", "value": 173, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 298}}
:::MLLOG {"namespace": "", "time_ms": 1760054410793, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_warmup_factor", "value": 0.0, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 302}}
:::MLLOG {"namespace": "", "time_ms": 1760054410793, "event_type": "POINT_IN_TIME", "key": "opt_adamw_weight_decay", "value": 0.0001, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 306}}
:::MLLOG {"namespace": "", "time_ms": 1760054410793, "event_type": "POINT_IN_TIME", "key": "opt_gradient_clip_norm", "value": 0.3, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 310}}
:::MLLOG {"namespace": "", "time_ms": 1760054410793, "event_type": "POINT_IN_TIME", "key": "gradient_accumulation_steps", "value": 1, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 315}}
:::MLLOG {"namespace": "", "time_ms": 1760054410793, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_training_steps", "value": 800, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 316}}
:::MLLOG {"namespace": "", "time_ms": 1760054410793, "event_type": "POINT_IN_TIME", "key": "opt_base_learning_rate", "value": 0.00045, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 319}}
:::MLLOG {"namespace": "", "time_ms": 1760054410793, "event_type": "POINT_IN_TIME", "key": "lora_rank", "value": 16, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 320}}
:::MLLOG {"namespace": "", "time_ms": 1760054410794, "event_type": "POINT_IN_TIME", "key": "lora_alpha", "value": 32, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 323}}
:::MLLOG {"namespace": "", "time_ms": 1760054480674, "event_type": "INTERVAL_END", "key": "init_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 219}}
:::MLLOG {"namespace": "", "time_ms": 1760054480675, "event_type": "INTERVAL_START", "key": "run_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 219}}
:::MLLOG {"namespace": "", "time_ms": 1760054480675, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 220, "samples_count": 0}}
:::MLLOG {"namespace": "", "time_ms": 1760055019930, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 2.880727573525041}, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 242, "step": 1536}}
:::MLLOG {"namespace": "", "time_ms": 1760055019930, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 174, "samples_count": 1536, "curr_global_step": 192, "self.gbs": 8}}
:::MLLOG {"namespace": "", "time_ms": 1760055019930, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 183, "samples_count": 1536}}
:::MLLOG {"namespace": "", "time_ms": 1760055045687, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.9448320865631104, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 262, "samples_count": 1536}}
:::MLLOG {"namespace": "", "time_ms": 1760055045687, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 267, "samples_count": 1536}}
:::MLLOG {"namespace": "", "time_ms": 1760055045687, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 201, "samples_count": 1536}}
:::MLLOG {"namespace": "", "time_ms": 1760055179264, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 2.8752752262966617}, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 242, "step": 1920}}
:::MLLOG {"namespace": "", "time_ms": 1760055179265, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 174, "samples_count": 1920, "curr_global_step": 240, "self.gbs": 8}}
:::MLLOG {"namespace": "", "time_ms": 1760055179265, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 183, "samples_count": 1920}}
:::MLLOG {"namespace": "", "time_ms": 1760055205175, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.9360510110855103, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 262, "samples_count": 1920}}
:::MLLOG {"namespace": "", "time_ms": 1760055205176, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 267, "samples_count": 1920}}
:::MLLOG {"namespace": "", "time_ms": 1760055205176, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 201, "samples_count": 1920}}
:::MLLOG {"namespace": "", "time_ms": 1760055338789, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 2.8744796121614153}, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 242, "step": 2304}}
:::MLLOG {"namespace": "", "time_ms": 1760055338790, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 174, "samples_count": 2304, "curr_global_step": 288, "self.gbs": 8}}
:::MLLOG {"namespace": "", "time_ms": 1760055338790, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 183, "samples_count": 2304}}
:::MLLOG {"namespace": "", "time_ms": 1760055364734, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.9313672184944153, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 262, "samples_count": 2304}}
:::MLLOG {"namespace": "", "time_ms": 1760055364734, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 267, "samples_count": 2304}}
:::MLLOG {"namespace": "", "time_ms": 1760055364734, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 201, "samples_count": 2304}}
:::MLLOG {"namespace": "", "time_ms": 1760055498400, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 2.873359354174258}, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 242, "step": 2688}}
:::MLLOG {"namespace": "", "time_ms": 1760055498401, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 174, "samples_count": 2688, "curr_global_step": 336, "self.gbs": 8}}
:::MLLOG {"namespace": "", "time_ms": 1760055498401, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 183, "samples_count": 2688}}
:::MLLOG {"namespace": "", "time_ms": 1760055524334, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.9289332032203674, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 262, "samples_count": 2688}}
:::MLLOG {"namespace": "", "time_ms": 1760055524334, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 267, "samples_count": 2688}}
:::MLLOG {"namespace": "", "time_ms": 1760055524334, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 201, "samples_count": 2688}}
:::MLLOG {"namespace": "", "time_ms": 1760055657982, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 2.8737525198462794}, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 242, "step": 3072}}
:::MLLOG {"namespace": "", "time_ms": 1760055657983, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 174, "samples_count": 3072, "curr_global_step": 384, "self.gbs": 8}}
:::MLLOG {"namespace": "", "time_ms": 1760055657983, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 183, "samples_count": 3072}}
:::MLLOG {"namespace": "", "time_ms": 1760055683909, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.9255889654159546, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 262, "samples_count": 3072}}
:::MLLOG {"namespace": "", "time_ms": 1760055683909, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 267, "samples_count": 3072}}
:::MLLOG {"namespace": "", "time_ms": 1760055683909, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 201, "samples_count": 3072}}
:::MLLOG {"namespace": "", "time_ms": 1760055817542, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"throughput": 2.8740751439045327}, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 242, "step": 3456}}
:::MLLOG {"namespace": "", "time_ms": 1760055817543, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 174, "samples_count": 3456, "curr_global_step": 432, "self.gbs": 8}}
:::MLLOG {"namespace": "", "time_ms": 1760055817543, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 183, "samples_count": 3456}}
:::MLLOG {"namespace": "", "time_ms": 1760055843470, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.9211192727088928, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 262, "samples_count": 3456}}
:::MLLOG {"namespace": "", "time_ms": 1760055843470, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 267, "samples_count": 3456}}
:::MLLOG {"namespace": "", "time_ms": 1760055843475, "event_type": "INTERVAL_END", "key": "run_stop", "value": null, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 230, "samples_count": 3456, "status": "success", "duration": "1362.7994058132172 sec -> 22.713323430220285 minutes"}}
[NeMo E 2025-10-10 00:24:03 perf_metrics:110] Failed to calculate TFLOPs per sec per GPU.
    FLOPs measurement not supported for finetuning jobs
:::MLLOG {"namespace": "", "time_ms": 1760055843475, "event_type": "POINT_IN_TIME", "key": "tflops_per_sec_per_gpu", "value": -1, "metadata": {"file": "/workspace/src/callbacks/custom_callbacks.py", "lineno": 343}}
ENDING TIMING RUN AT 2025-10-10 12:24:34 AM
RESULT,LLM_FINETUNING,,1549,AMD,2025-10-09 11:58:45 PM
Config shell script: conf/config_MI325X_1x8x1.sh
Starting single-node MLPerf training benchmark...
get context parallel size: 1
Running in single-node mode...
MLPerf training benchmark completed.
